# Maintainer: Luke Labrie-Cleary <luke.cleary@copenhagenatomics.com>
pkgname=moab
pkgver=5.4.1
pkgrel=1
pkgdesc="The Mesh-Oriented datABase MOAB is a component for representing and evaluating mesh data"
arch=('any')
url="https://bitbucket.org/fathomteam/moab"
license=('GPL3')

depends=(
	python-numpy
	blas
	lapack
)
makedepends=(
	git
	eigen
	netcdf
	hdf5
	cython
	python-setuptools
	"glibc>=2.34"
)

provides=("${pkgname%}")
source=('http://ftp.mcs.anl.gov/pub/fathom/moab-5.4.1.tar.gz')
md5sums=('620850a74d7af431599e7328a36f0440')

build() {
	cd $srcdir/$pkgname-$pkgver
	mkdir build && cd build
	cmake .. -DENABLE_HDF5=ON \
	         -DENABLE_NETCDF=ON \
	         -DENABLE_FORTRAN=OFF \
	         -DENABLE_BLASLAPACK=OFF \
			 -DENABLE_PYMOAB=ON \
			 -DCMAKE_INSTALL_PREFIX=${pkgdir}/opt
	make
}

package() {
	cd $srcdir/$pkgname-$pkgver/build
	make DESTDIR="$pkgdir/" install
	cd pymoab && ls
	bash install.sh
	python setup.py install
}
